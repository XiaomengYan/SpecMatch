{
    "collab_server" : "",
    "contents" : "#include <RcppArmadillo.h>\n#include <cmath>\n#include <vector>\nusing namespace Rcpp;\nusing namespace arma;\n\n// [[Rcpp::export]]\ndouble CrossCorr(arma::vec TestSignal, arma::vec TemplateSignal){\n  //After determine the StartEnd point and intepolate towards the TestSignal. Now TestSignal and TemplateSignal\n  // are aligned. Apply the general Cross Correlation\n  int N = TestSignal.size(); // The size of TestSignal and TemplateSignal(cut-off) are the same.\n  double Testbar = mean(TestSignal);\n  double Templatebar = mean(TemplateSignal);\n  double Testsigma = stddev(TestSignal);\n  double Templatesigma = stddev(TemplateSignal);\n  double tmp = 0;\n  for(int n=0;n<N;n++){\n    // Rcpp::Rcout<<TestSignal.at(n)-Testbar<<std::endl;\n    // Rcpp::Rcout<<TemplateSignal.at(n)-Templatebar<<std::endl;\n    tmp = tmp + (TestSignal.at(n)-Testbar)*(TemplateSignal.at(n)-Templatebar);\n  }//for\n  return tmp/((N-1)*Testsigma*Templatesigma);\n}\n\n\n\n//[[Rcpp::export]]\ndouble test(arma::vec hi){\n  return mean(hi);\n}\n\n//[[Rcpp::export]]\narma::vec DeterStartEnd(arma::vec TestSignalWave, arma::vec TemplateSignalWave){\n  // To determine where to start the cross-correlation respect to the Template Signal\n  double Templatemin = TemplateSignalWave.min();\n  double Templatemax = TemplateSignalWave.max();\n  int N_template = TemplateSignalWave.size();\n  double Testmin = TestSignalWave.min();\n  double Testmax = TestSignalWave.max();\n  arma::vec StartEnd(2,fill::zeros);\n  //Determine the start point\n  if(Testmin>Templatemin && Testmin<Templatemax){\n    for(int n=0;n<N_template;n++){\n      if(Testmin>TemplateSignalWave.at(n)&&Testmin <= TemplateSignalWave.at(n+1)){StartEnd.at(0) = n+2;break;}//if\n    }//for\n  }else if(Testmin <= Templatemin){\n    StartEnd.at(0) = 1;\n  }else{\n    StartEnd.at(0) = N_template+1;\n  }\n  //Determine the end point\n  if(Testmax>Templatemin && Testmax<Templatemax){\n    for(int n=0;n<N_template;n++){\n      if(Testmax>TemplateSignalWave.at(n)&&Testmax <= TemplateSignalWave.at(n+1)){StartEnd.at(1) = n+1;break;}//if\n    }//for\n  }else if(Testmax <= Templatemin){\n    StartEnd.at(1) = 0;\n  }else{\n    StartEnd.at(1) = N_template;\n  }\n  return StartEnd;\n}\n",
    "created" : 1541531862625.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "431477991",
    "id" : "D2FF133B",
    "lastKnownWriteTime" : 1541531810,
    "last_content_update" : 1541531810,
    "path" : "~/Dropbox/project/Wang/SpecMatch/src/CrossCorr.cpp",
    "project_path" : "src/CrossCorr.cpp",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "cpp"
}